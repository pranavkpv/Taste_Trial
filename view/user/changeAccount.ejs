<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


<style>
  .field-icon{
    margin-top:-28px
  }
  .account-form-wrapper {
    padding: 2rem;
    background: #f8f9fa;
    min-height: 100vh;
  }

  .form-card {
    background: white;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 0 40px rgba(0, 0, 0, 0.1);
    border: none;
  }

  .form-header {
    background: linear-gradient(135deg, #4e73df 0%, #224abe 100%);
    padding: 1.5rem;
    position: relative;
  }

  .form-header h5 {
    font-size: 1.5rem;
    font-weight: 600;
    margin: 0;
    color: white;
  }

  .form-header::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: rgba(255, 255, 255, 0.2);
  }

  .form-body {
    padding: 2rem;
  }

  .form-control {
    border: 2px solid #e9ecef;
    padding: 0.8rem 1rem;
    font-size: 1rem;
    border-radius: 8px;
    transition: all 0.3s ease;
  }

  .form-control:focus {
    border-color: #4e73df;
    box-shadow: 0 0 0 0.2rem rgba(78, 115, 223, 0.1);
  }

  .form-label {
    font-weight: 600;
    color: #495057;
    margin-bottom: 0.5rem;
  }

  .field-group {
    margin-bottom: 1.5rem;
    position: relative;
  }

  .field-icon {
    position: absolute;
    right: 15px;
    top: 40px;
    color: #6c757d;
  }

  .submit-btn {
    background: linear-gradient(135deg, #4e73df 0%, #224abe 100%);
    border: none;
    padding: 1rem;
    font-weight: 600;
    border-radius: 8px;
    transition: all 0.3s ease;
  }

  .submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(78, 115, 223, 0.3);
  }

  .error-message {
    color: #dc3545;
    font-size: 0.875rem;
    margin-top: 0.5rem;
    display: none;
  }

  .error-message.show {
    display: block;
  }

  /* Animation for form fields */
  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(10px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .field-group {
    animation: slideUp 0.3s ease-out forwards;
    animation-delay: calc(var(--order) * 0.1s);
  }
</style>
<%- include('partials/userheader') %>
<div class="row">
  <div class="col-md-2 menu">
    <%- include('partials/profileside') %>
  </div>
  <div class="col-md-10 account-form-wrapper">
    <div class="form-card" style="margin-top:81px">
      <div class="form-header">
        <h5>
          <i class="fas fa-user-edit me-2"></i>
          Update Profile Information
        </h5>
      </div>
      <div class="form-body">
        <form action="/user/updateAction" method="post" onsubmit="validateForm()">
          <input type="hidden" value="<%= userid %>" name="userid">
          <input type="text" name="email1" style="display: none;" autocomplete="username">
          <input type="password" name="password1" style="display: none;" autocomplete="current-password">

          <!-- First Name -->
          <div class="field-group" style="--order: 1">
            <label for="firstName" class="form-label">First Name</label>
            <div class="input-group">
              <input type="text" name="fname" class="form-control" id="firstName" placeholder="Enter your first name"
                value="<%= users.firstname %>">
              <span class="field-icon">
                <i class="fas fa-user"></i>
              </span>
            </div>
            <p class="error-message" id="hiddenFirstname">First name is required</p>
          </div>

          <!-- Last Name -->
          <div class="field-group" style="--order: 2">
            <label for="lastName" class="form-label">Last Name</label>
            <div class="input-group">
              <input type="text" name="lname" class="form-control" id="lastName" placeholder="Enter your last name"
                value="<%= users.lastname %>">
              <span class="field-icon">
                <i class="fas fa-user"></i>
              </span>
            </div>
            <p class="error-message" id="hiddenSecondname">Last name is required</p>
          </div>

          <!-- Phone Number -->
          <div class="field-group" style="--order: 3">
            <label for="phoneNumber" class="form-label">Phone Number</label>
            <div class="input-group">
              <input type="tel" name="phone" class="form-control" id="phoneNumber" placeholder="Enter your phone number"
                value="<%= users.phonenumber %>">
              <span class="field-icon">
                <i class="fas fa-phone"></i>
              </span>
            </div>
            <p class="error-message" id="hiddenPhone">Phone number is required</p>
          </div>

          <!-- Email -->
          <div class="field-group" style="--order: 4">
            <label for="email" class="form-label">Email</label>
            <div class="input-group">
              <input type="email" name="email" class="form-control" id="email" placeholder="Enter your email"
                value="<%= users.email %>">
              <span class="field-icon">
                <i class="fas fa-envelope"></i>
              </span>
            </div>
            <p class="error-message" id="hiddenEmail">Email is required</p>
          </div>

          <!-- Submit Button -->
          <div class="field-group" style="--order: 5">
            <button type="submit" class="btn submit-btn w-100">
              <i class="fas fa-save me-2"></i>
              Save Changes
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

</div>
<%- include('partials/userfooter') %>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<% if (successmessage && successmessage.length>0) { %>
<script>
  Swal.fire({
    text: "<%= successmessage %>",
    icon: "success"
  });
</script>
<% } %>

<script>
  function validateForm(event) {
    let isValid = true; // To track form validity

    // Get the form fields
    const firstname = document.getElementById('firstName').value.trim();
    const lastname = document.getElementById('lastName').value.trim();
    const phonenumber = document.getElementById('phoneNumber').value.trim();
    const email = document.getElementById('email').value.trim();

    // Get the error message elements
    const hiddenFirstname = document.getElementById('hiddenFirstname');
    const hiddenLastname = document.getElementById('hiddenSecondname');
    const hiddenPhone = document.getElementById('hiddenPhone');
    const hiddenEmail = document.getElementById('hiddenEmail');

    // Validate first name
    if (firstname === '') {
      hiddenFirstname.classList.remove('d-none');
      isValid = false;
    } else {
      hiddenFirstname.classList.add('d-none');
    }

    // Validate last name
    if (lastname === '') {
      hiddenLastname.classList.remove('d-none');
      isValid = false;
    } else {
      hiddenLastname.classList.add('d-none');
    }

    // Validate phone number
    const phoneRegex = /^[0-9]{10}$/; // Example: 10-digit phone number
    if (phonenumber === '' || !phoneRegex.test(phonenumber)) {
      hiddenPhone.textContent = phonenumber === ''
        ? 'Phone number is required'
        : 'Enter a valid 10-digit phone number';
      hiddenPhone.classList.remove('d-none');
      isValid = false;
    } else {
      hiddenPhone.classList.add('d-none');
    }

    // Validate email
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; // Basic email regex
    if (email === '' || !emailRegex.test(email)) {
      hiddenEmail.textContent = email === ''
        ? 'Email is required'
        : 'Enter a valid email address';
      hiddenEmail.classList.remove('d-none');
      isValid = false;
    } else {
      hiddenEmail.classList.add('d-none');
    }

    // If the form is invalid, prevent submission
    if (!isValid) {
      event.preventDefault();
    }
  }

  // Attach the validation function to the form's submit event
  document.querySelector('form').addEventListener('submit', validateForm);
</script>